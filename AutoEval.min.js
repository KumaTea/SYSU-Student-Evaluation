let tm,fn,rp,im=0,dl=2e3,gr=1;function sl(e){return new Promise(t=>setTimeout(t,e))}function ri(e,t){let l=e.value;e.value=t;let r=new Event("input",{bubbles:!0});r.simulated=!0;let a=e._valueTracker;a&&a.setValue(l),e.dispatchEvent(r)}async function ae(){for(rp=0;rp<5;rp++){for(tm=0;tm<10&&(await sl(dl),document.querySelector(".stu-eva-con").querySelectorAll(".sys-card")[im]);tm++){document.querySelector(".stu-eva-con").querySelectorAll(".sys-card")[im].querySelector("button").click(),await sl(dl);let e=document.querySelectorAll(".ant-table-wrapper")[1].querySelector(".ant-table-tbody").querySelectorAll(".ant-table-row");for(let t=0;t<e.length;t++){let l=e[t].querySelectorAll("td");ri(e[t].querySelector("input.ant-input"),Math.round(gr*parseInt(l[l.length-2].textContent)))}await sl(dl),document.querySelector(".ant-modal-footer").querySelector(".ant-btn-primary").click(),await sl(dl);let t,l=!0;try{t=document.querySelector(".ant-modal-body").querySelectorAll("img")}catch(e){t=[],l=!1}for(;l;){if(!(t.length>0)){l=!1;break}if("验证码"!==t[t.length-1].alt){l=!1;break}alert("请手动输入验证码，然后稍作等待。"),await sl(10*dl);try{document.querySelector(".ant-modal-footer").querySelector(".ant-btn-primary").click()}catch(e){}await sl(dl);try{t=document.querySelector(".ant-modal-body").querySelectorAll("img")}catch(e){t=[],l=!1}}null!=document.querySelector(".ant-modal-close")&&(document.querySelector(".ant-modal-close").click(),im++)}document.querySelector(".stu-eva-con").querySelector(".stu-eva-more").querySelector("i").click()}fn=im>0?"评教完成。\n共"+im+"次无法评价。":"评教已顺利完成。"}ae().then(e=>{alert(fn)});