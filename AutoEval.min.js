var times,repeat,finish,delay=2e3,item=0,good_rate=1;function sleep(e){return new Promise(t=>setTimeout(t,e))}function react_input(e,t){let r=e.value;e.value=t;let l=new Event("input",{bubbles:!0});l.simulated=!0;let a=e._valueTracker;a&&a.setValue(r),e.dispatchEvent(l)}async function autoEval(){for(repeat=0;repeat<5;repeat++){for(times=0;times<10&&(await sleep(delay),document.querySelector(".stu-eva-con").querySelectorAll(".sys-card")[item]);times++){document.querySelector(".stu-eva-con").querySelectorAll(".sys-card")[item].querySelector("button").click(),await sleep(delay);for(var e=document.querySelectorAll(".ant-table-wrapper")[1].querySelector(".ant-table-tbody").querySelectorAll(".ant-table-row"),t=0;t<e.length;t++){var r=e[t].querySelectorAll("td");react_input(e[t].querySelector("input.ant-input"),Math.round(good_rate*parseInt(r[r.length-2].textContent)))}await sleep(delay),document.querySelector(".ant-modal-footer").querySelector(".ant-btn-primary").click(),await sleep(delay);var l,a=!0;try{l=document.querySelector(".ant-modal-body").querySelectorAll("img")}catch(e){l=[],a=!1}for(;a;){if(!(l.length>0)){a=!1;break}if("验证码"!=l[l.length-1].alt){a=!1;break}alert("请手动输入验证码，然后稍作等待。"),await sleep(10*delay);try{document.querySelector(".ant-modal-footer").querySelector(".ant-btn-primary").click()}catch(e){}await sleep(delay);try{l=document.querySelector(".ant-modal-body").querySelectorAll("img")}catch(e){l=[],a=!1}}null!=document.querySelector(".ant-modal-close")&&(document.querySelector(".ant-modal-close").click(),item++)}document.querySelector(".stu-eva-con").querySelector(".stu-eva-more").querySelector("i").click()}finish=item>0?"评教完成。\n共"+item+"次无法评价。":"评教已顺利完成。",alert(finish)}autoEval();